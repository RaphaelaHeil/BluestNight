{{ $page := .page }}
{{ $site := .site }}
{{ range sort .menu }}
  <li class="{{if or ($page.IsMenuCurrent "main" .) ($page.HasMenuCurrent "main" .) }}active{{end}}">
    <a class="main-nav button" href="{{ .URL }}">{{ .Name | upper }}</a>
    {{ if .HasChildren }}
      <ul class="menu" data-auto-height="true">
      {{ partial "nested_menu.html" (dict "menu" .Children "page" $page "site" $site) }}
      </ul>
    {{ end }}
  </li>
{{ end }}
